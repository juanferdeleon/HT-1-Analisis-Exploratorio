---
title: "HT 6. Regresion Logistica"
author: "Juan De Leon, Maria Jose Castro, Jose Block"
date: "14/04/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## - Seleccion, filtracion y/o creacion de datos:

Se generan las tres variables dicotomicas segun tipoDeCasa:
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(caret)
df = read.csv("./train.csv")
df$tipoDeCasa = as.integer(as.character( cut(df$SalePrice,c(0,145000,205000,410000), labels = c(1, 2, 3))))
df$CasasEconomicas <- as.integer(ifelse(df$tipoDeCasa == 1,1,0)) 
df$CasasIntermedias <- as.integer(ifelse(df$tipoDeCasa == 2,1,0))
df$CasasCaras <- as.integer(ifelse(df$tipoDeCasa == 3,1,0))
dicot<- df %>% select(82:85)
head(dicot)
```
## - Regresion Logistica
```{r echo=FALSE}
porcentaje<-0.7
set.seed(123)
df[sapply(df, is.character)] <- lapply(df[sapply(df, is.character)],as.factor)
corte <- sample(nrow(df),nrow(df)*porcentaje)
train<-df[corte,]
test<-df[-corte,]
str(df)
modelo<-glm(CasasEconomicas~., data = train[,c(2:5,11:72,8,9,76:80,83)],family = binomial(), maxit=100)
str(train$MSZoning)
str(test$MSZoning)
modelo
```
## - Prediccion
```{r echo=FALSE}
#Error:
#pred<-predict(modelo,newdata = test[,c(2:5,11:72,8,9,76:80)], type ="response")
#prediccion<-ifelse(pred>=0.5,1,0)
#confusionMatrix(as.factor(test$CasasEconomicas),as.factor(prediccion))
```

