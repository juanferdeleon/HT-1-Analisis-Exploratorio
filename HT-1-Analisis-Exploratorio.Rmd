---
title: "HT-1-Analisis-Exploratorio"
author: "Juan De Leon, Maria Jose Castro, Jose Block"
date: "2/8/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
dataframe = read.csv("./Data/tmdb-movies.csv")
```

## Ejercicios

1. Haga una exploración rápida de sus datos, para eso haga un resumen de su conjunto de datos.
2. Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa continua, cuantitativa discreta).
```{r echo=FALSE}
data.frame("Variable"=c(colnames(dataframe)), "Tipo de Variable"=c("N/A", "N/A", "Cuantitativa Continua", "Cuantitativa Discreta", "Cuantitativa Discreta", "Cualitativa Nominal", "Cualitativa Nominal", "Cualitativa Nominal", "Cualitativa Nominal", "Cualitativa Nominal", "Cualitativa Nominal", "Cualitativa Nominal", "Cuantitativa Discreta", "Cualitativa Nominal", "Cualitativa Nominal", "Cuantitativa Discreta", "Cuantitativa Discreta", "Cuantitativa Continua", "Cuantitativa Discreta", "Cuantitativa Continua", "Cuantitativa Continua"))
```
3. Investigue si las variables cuantitativas siguen una distribución normal y haga una tabla de frecuencias de las variables cualitativas. Explique todos los resultados.

```{r echo=FALSE}
popularity <- rnorm(dataframe$popularity)
hist(popularity, main="Distribucion de Popularity")
budget <- rnorm(dataframe$budget)
hist(budget, main="Distribucion de budget")
revenue <- rnorm(dataframe$revenue)
hist(revenue, main="Distribucion de revenue")
runtime <- rnorm(dataframe$runtime)
hist(runtime, main="Distribucion de runtime")
vote_count <- rnorm(dataframe$vote_count)
hist(vote_count, main="Distribucion de vote_count")
vote_average <- rnorm(dataframe$vote_average)
hist(vote_average, main="Distribucion de vote_average")
budget_adj <- rnorm(dataframe$budget_adj)
hist(budget_adj, main="Distribucion de budget_adj")
revenue_adj <- rnorm(dataframe$revenue_adj)
hist(revenue_adj, main="Distribucion de revenue_adj")
```

* Debido a que las tablas de frecuencia son muy grandes dejamos indicado como se obentrian todas las tablas de frecuencia de las variables cualitativas.

```
table(dataframe$original_title)
table(dataframe$cast)
table(dataframe$homepage)
table(dataframe$director)
table(dataframe$tagline)
table(dataframe$keywords)
table(dataframe$overview)
table(dataframe$genreS)
table(dataframe$production_companies)
```

4. Responda las siguientes preguntas:
    - ¿Cuáles son las 10 películas que contaron con más presupuesto?
    ```{r echo=FALSE, include=FALSE}
    library(dplyr)
    ```
    ```{r echo=FALSE}
    head(dataframe[order(-dataframe$budget),], 10)[, c("id", "original_title", "budget"), drop=FALSE]
    ```
    - ¿Cuáles son las 10 películas que más ingresos tuvieron?
    ```{r echo=FALSE}
    head(dataframe[order(-dataframe$revenue),], 10)[, c("id", "original_title", "revenue"), drop=FALSE]
    ```
    - ¿Cuál es la película que más votos tuvo?
    ```{r echo=FALSE}
    head(dataframe[order(-dataframe$vote_count),], 1)[, c("id", "original_title", "vote_count"), drop=FALSE]
    ```
    - ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios?
    ```{r echo=FALSE}
    head(dataframe[order(dataframe$vote_average),], 2)[, c("id", "original_title", "vote_average"), drop=FALSE]
    ```
    - ¿Cuántas películas se hicieron en cada año? ¿En qué año se hicieron más películas? Haga un gráfico de barras
    ```{r echo=FALSE}
    library(dplyr)
    ```
    ```{r echo=FALSE}
    releases_per_year <- data.frame(tally(group_by(dataframe, release_year)))
    releases_per_year
    barplot(releases_per_year$n, names.arg = releases_per_year$release_year)
    head(releases_per_year[order(-releases_per_year$n),], 1)[,, drop=FALSE]
    ```
    - ¿Cuál es el género principal de las 20 películas más populares?
```{r echo=FALSE, warning=FALSE}
library(tidyr)
movies<-read.csv("./Data/tmdb-movies.csv")
popular20_ <- head(movies[order(movies$popularity, decreasing = TRUE),],20)
#obtenemos el genero con la funcion separate y contamos
pf<- popular20_ %>% separate(genres, c("p_genre", "SE_genre", "3_genre", NA), sep="([|?:])")
table(pf$p_genre)
```
    
    - ¿Cuál es el género que predomina en el conjunto de datos? Represéntelo usando un gráfico
```{r echo=FALSE, warning=FALSE}
pg <- movies %>% separate(genres, c("p_genre", "SE_genre", "3_genre", NA), sep="([|?:])")
#plot de los generos
barplot(
  table(pg$p_genre),
  main="Géneros más comunes",
  col=rainbow(15),
  xlab="Géneros",  
  ylab="Cantidad de Peliculas",
  xlim=c(0,25),
  ylim=c(0,2500)
  )

```
    
    - ¿Las películas de qué genero principal obtuvieron mayores ganancias?
```{r echo=FALSE, warning=FALSE}
ph<-pg[order(movies$revenue, decreasing = TRUE),]
result<-aggregate(ph[5], list(ph$p_genre), mean )
phr<-result[-c(1),]
#View(phr)
barplot(phr$revenue,
        las= 2,
        names.arg =phr$Group.1,
        main="Las peliculas con mayores ganacias",
        col=rainbow(15),
        xlab="Géneros",  
        ylab="Total",
        xlim=c(0,19),
        ylim=c(0,	124755984.2)
        
        )
```
    
    - ¿Las películas de qué genero principal necesitaron mayor presupuesto?
```{r echo=FALSE, warning=FALSE}
budget<- movies %>% separate(genres, c("p_genre", "SE_genre", "3_genre", NA),)
#View(budget)
orderBud<-budget[order(movies$budget, decreasing = TRUE),]

#View(orderBud)
```


```{r echo=FALSE, warning=FALSE}
resultI<-aggregate(orderBud$budget, list(orderBud$p_genre), mean )
pi<-resultI[-c(1),]
View(pi)
head(resultI)
#table(pi)
names(pi)<-c('Generos','budget')
barplot(pi$budget,
        las= 2,
        names.arg =pi$Generos,
        main="Los generos con mayor presupuesto",
        col=rainbow(15),
        xlab="Géneros",  
        ylab="Presupuesto",
        xlim=c(0,19),
        ylim=c(0, 37675772.0)
)
```
    
    - ¿Quiénes son los 20 mejores directores que hicieron películas altamente calificadas?
```{r echo=FALSE, warning=FALSE}
pj<- head(movies[order(movies$vote_average, decreasing = TRUE),],20,na.rm = TRUE)
#View(pj)
#Aqui contamos las que corresponden a cada director
table(pj$director)
```
    
    - ¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos? Haga los gráficos que necesite, histograma, diagrama de dispersión
    - ¿Se asocian ciertos meses de lanzamiento con mejores ingresos?
    - ¿En qué meses se han visto los lanzamientos máximos?
    - ¿Cómo se correlacionan las calificaciones con el éxito comercial?
    - ¿A qué género principal pertenecen las películas más largas?
5. Genere usted otras seis preguntas que le parezcan interesantes porque le permitan realizar otras exploraciones y respóndalas. No puede repetir ninguna de las instrucciones anteriores.
    